{% extends 'main.html' %}
{% load static %}

{% block title %}
Histórico de Pedidos
{% endblock %}

{% block head_extra %}
<!-- CSS específico da página -->
<link rel="stylesheet" href="{% static 'css/order_history.css' %}">
{% endblock head_extra %}

{% block content %}
<main class="history-container">

  <div class="history-header">
    <h1 class="flex items-center gap-2">
      <i class="fa-solid fa-box-archive"></i>
      Histórico de Pedidos
    </h1>

    <a href="{% url 'storage:request-order' %}" class="btn-new-order">
      <i class="fa-solid fa-plus"></i>
      Novo Pedido
    </a>
  </div>

  <section class="orders-list">

    {% for order in orders %}
    <div class="order-card">

      <div class="order-header">
        <span class="order-id">Pedido #{{ order.id }}</span>

        {% if order.is_approved %}
        <span class="status approved">
          <i class="fa-solid fa-check"></i> Aprovado
        </span>
        {% else %}
        <span class="status pending">
          <i class="fa-solid fa-hourglass-half"></i> Pendente
        </span>
        {% endif %}
      </div>

      <span class="order-date">
        <i class="fa-regular fa-clock"></i>
        {{ order.created_at|date:"d/m/Y H:i" }}
      </span>

      <ul class="order-items">
        {% for item in order.orderitem_set.all %}
        <li>
          <span class="item-name">{{ item.item.name }}</span>
          <span class="item-qty">x{{ item.quantity }}</span>
        </li>
        {% endfor %}
      </ul>

    </div>

    {% empty %}
    <p class="empty-message text-center">
      <i class="fa-regular fa-folder-open text-3xl mb-2"></i><br>
      Você ainda não realizou nenhum pedido.
    </p>
    {% endfor %}

  </section>

</main>
{% endblock content %}
